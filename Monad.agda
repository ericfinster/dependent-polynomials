--
--  Monad.agda - Monads generated by dependent polynomials
--

open import Cubical.Foundations.Prelude

open import TyStr
open import DepPoly

module Monad where

  record Monad (ğ•‹ : TyStr) : Typeâ‚ where
    field
      P : DepPoly ğ•‹ ğ•‹
      Î¼ : P âŠš P â‡’ P
      Î· : IdPoly ğ•‹ â‡’ P

  open Monad

  assoc-mult-left : {ğ•‹ : TyStr} (M : Monad ğ•‹)
    â†’ (Î“ : Ctx ğ•‹) (A : Ty ğ•‹) 
    â†’ (t : Tm ((P M âŠš P M) âŠš P M) Î“ A)
    â†’ Tm (P M) Î“ A 
  assoc-mult-left M Î“ A (Î” , Ïƒ , t) =
    Tmâ‡’ (Î¼ M) (Î” , Substâ‡’ (Î¼ M) Ïƒ , t)

  assoc-mult-right : {ğ•‹ : TyStr} (M : Monad ğ•‹)
    â†’ (Î“ : Ctx ğ•‹) (A : Ty ğ•‹) 
    â†’ (t : Tm (P M âŠš (P M âŠš P M)) Î“ A)
    â†’ Tm (P M) Î“ A 
  assoc-mult-right M Î“ A (Î” , Ïƒ , Î˜ , Ï„ , t) =
    Tmâ‡’ (Î¼ M) (Î” , Ïƒ , Tmâ‡’ (Î¼ M) (Î˜ , Ï„ , t)) 

  unit-mult-left : {ğ•‹ : TyStr} (M : Monad ğ•‹)
    â†’ (Î“ : Ctx ğ•‹) (A : Ty ğ•‹) (t : Tm (P M) Î“ A)
    â†’ Tm (P M) Î“ A
  unit-mult-left M Î“ A t =
    Tmâ‡’ (Î¼ M) (Î“ , Substâ‡’ (Î· M) (idSubst Î“) , t)

  unit-mult-right : {ğ•‹ : TyStr} (M : Monad ğ•‹)
    â†’ (Î“ : Ctx ğ•‹) (A : Ty ğ•‹) (t : Tm (P M) Î“ A)
    â†’ Tm (P M) Î“ A
  unit-mult-right M Î“ A t = 
    Tmâ‡’ (Î¼ M) (A â–º Ïµ , tmToSubst t , Tmâ‡’ (Î· M) (idT A))

  
